---
when:
  event: pull_request

steps:
  woodpecker:
    image: woodpeckerci/woodpecker-cli:v3.9.0-alpine
    commands:
      - woodpecker-cli
        lint
        --plugins-privileged="woodpeckerci/plugin-docker-buildx"
        .woodpecker/*.yaml
    depends_on: []

  dockerfile:
    image: ghcr.io/hadolint/hadolint:v2.13.1
    depends_on: []

  cspell:
    image: ghcr.io/streetsidesoftware/cspell:9.2.0
    commands:
      - /usr/local/bin/cspell-cli lint .
    depends_on: []

  golangci-lint:
    image: golangci/golangci-lint:v2.4.0
    commands:
      - golangci-lint run --timeout 15m
    depends_on: []

  renovate:
    # We don't expect renovate to introduce breaking changes on minor and patch
    # releases. So we pin the major version only and force Woodpecker to pull
    # the latest image on every run.
    # This is to reduce the noise of renovate PRs to update the validator image.
    image: renovate/renovate:41
    pull: true
    commands:
      - renovate-config-validator --strict
    depends_on: []

  yamllint:
    image: python:3.13.7-alpine3.22
    commands:
      - pip install yamllint
      - yamllint --strict .
    depends_on: []

  markdownlint:
    image: davidanson/markdownlint-cli2:v0.18.1
    commands:
      - markdownlint-cli2 **/*.md
    depends_on: []
